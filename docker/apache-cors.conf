# CORS para /api - CR√çTICO: incluir X-Tenant para multi-tenant
# Se aplica cuando Origin coincide; Access-Control-Allow-Origin se rellena con el valor de Origin
<IfModule mod_headers.c>
    <IfModule mod_setenvif.c>
        <Location "/api">
            SetEnvIf Origin "^https://[a-z0-9-]+\.lapesquerapp\.es$" ORIGIN_ALLOWED=$0
            SetEnvIf Origin "^https://lapesquerapp\.es$" ORIGIN_ALLOWED=$0
            SetEnvIf Origin "^https://[a-z0-9-]+\.congeladosbrisamar\.es$" ORIGIN_ALLOWED=$0
            SetEnvIf Origin "^http://localhost(:[0-9]+)?$" ORIGIN_ALLOWED=$0
            SetEnvIf Origin "^http://127\.0\.0\.1(:[0-9]+)?$" ORIGIN_ALLOWED=$0

            Header always set Access-Control-Allow-Origin "%{ORIGIN_ALLOWED}e" env=ORIGIN_ALLOWED
            Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH" env=ORIGIN_ALLOWED
            Header always set Access-Control-Allow-Headers "Authorization, Accept, Origin, Content-Type, X-Tenant" env=ORIGIN_ALLOWED
            Header always set Access-Control-Allow-Credentials "true" env=ORIGIN_ALLOWED
            Header always set Vary "Origin" env=ORIGIN_ALLOWED
        </Location>
    </IfModule>
</IfModule>
